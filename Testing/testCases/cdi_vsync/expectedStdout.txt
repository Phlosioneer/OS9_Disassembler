    0
    1                      * OS-9 system function equates
    2
    3  00006 0006 F$Exit     equ    $06        
    4  00021 0021 F$TLink    equ    $21        
    5  0008c 008c I$WritLn   equ    $8c        
    6
    7  00000 0001 Prgrm      set    $1         
    8  00000 0001 Objct      set    $1         
    9  00000 0080 ReEnt      set    $80        
   10
   11  00000 0080            psect  test.os9_a,(Prgrm<<8)|Objct,(ReEnt<<8)|1,7,0,cstart,ctrap 
   12
   13
   14                       * OS9 data area definitions
   15
   16  00000 0000            vsect             
   17  00000 0000 D00000     ds.b   4          
   18  00004 0000 D00004     ds.b   4          
   19  00008 0000 D00008     ds.b   4          
   20  0000c 0000 D0000c     ds.b   8          
   21  00014 0000 totalMemSize ds.b   4          
   22  00018 0000 D00018     ds.b   2          
   23  0001a 0000 D0001a     ds.b   16         
   24  0002a 0000 D0002a     ds.b   2          
   25  0002c 0000 D0002c     ds.b   26         
   26  00046 0000 D00046     ds.b   2          
   27  00048 0000 D00048     ds.b   26         
   28  00062 0000 D00062     ds.b   2          
   29  00064 0000 D00064     ds.b   826        
   30
   31 * Initialized Data Definitions
   32
   33  0039e 0000 D0039e     dc.w   $0000,$001e 
   33  003a2 0000 D003a2     dc.l   L00242     
   34  003a6 0000            ends              
   35
   36  00048 6364            bls.s  L000ae     
   37  0004a 695f            dc.w   $695f      
   38  0004c 7673            moveq  #115,d3    
   39  0004e 796e            dc.w   $796e      
   40  00050 6300            bls.w  L02d98     
   41  00052 0000 cstart     equ    *-2        
   42  00054 8010            or.b   (a0),d0    
   43  00056 2d46            move.l d6,totalMemSize(a6) 
   44  0005a 3d43            move.w d3,D00018(a6) 
   45  0005e 082b            btst.b #5,20(a3)  
   46  00064 670e            beq.s  L00074     
   47  00066 2d4c            move.l a4,D0001a(a6) 
   48  0006a 6608            bne.s  L00074     
   49  0006c 2d79            move.l (0).l,D0001a(a6) 
   50  00074 4a85 L00074     tst.l  d5         
   51  00076 671e            beq.s  L00096     
   52  00078 0805            btst.l #0,d5      
   53  0007c 6614            bne.s  L00092     
   54  0007e 41f5            lea.l  (a5,d5.l),a0 
   55  00082 4a68            tst.w  -2(a0)     
   56  00086 660a            bne.s  L00092     
   57  00088 5988            subq.l #4,a0      
   58  0008a 49e8            lea.l  -4(a0),a4  
   59  0008e 7001            moveq  #1,d0      
   60  00090 6026            bra.s  L000b8     
   61  00092 4235 L00092     clr.b  -1(a5,d5.l) 
   62  00096 204d L00096     movea.l a5,a0      
   63  00098 d7eb            adda.l 12(a3),a3  
   64  0009c 42a7            clr.l  -(sp)      
   65  0009e 2f0b            move.l a3,-(sp)   
   66  000a0 7401            moveq  #1,d2      
   67  000a2 203c            move.l #664,d0    
   68  000a8 4ebb            jsr    (pc,d0.l)  
   69  000ac 6076            bra.s  L00124     
   70  000ae 43e8 L000ae     lea.l  4(a0),a1   
   71  000b2 2d49            move.l a1,D003a2(a6) 
   72  000b6 7400            moveq  #0,d2      
   73  000b8 2260 L000b8     movea.l -(a0),a1   
   74  000ba 2e09            move.l a1,d7      
   75  000bc 670c            beq.s  L000ca     
   76  000be d3cd            adda.l a5,a1      
   77  000c0 4229            clr.b  -1(a1)     
   78  000c4 2089            move.l a1,(a0)    
   79  000c6 5282            addq.l #1,d2      
   80  000c8 60ee            bra.s  L000b8     
   81  000ca 5380 L000ca     subq.l #1,d0      
   82  000cc 67e0            beq.s  L000ae     
   83  000ce 4a82            tst.l  d2         
   84  000d0 6610            bne.s  L000e2     
   85  000d2 4a68            tst.w  -2(a0)     
   86  000d6 670a            beq.s  L000e2     
   87  000d8 4228            clr.b  -1(a0)     
   88  000dc 2448            movea.l a0,a2      
   89  000de 5888            addq.l #4,a0      
   90  000e0 6006            bra.s  L000e8     
   91  000e2 208d L000e2     move.l a5,(a0)    
   92  000e4 2448            movea.l a0,a2      
   93  000e6 5282            addq.l #1,d2      
   94  000e8 5282 L000e8     addq.l #1,d2      
   95  000ea 4a94            tst.l  (a4)       
   96  000ec 6718            beq.s  L00106     
   97  000ee 2854            movea.l (a4),a4    
   98  000f0 4a1c L000f0     tst.b  (a4)+      
   99  000f2 66fc            bne.s  L000f0     
  100  000f4 b5cc            cmpa.l a4,a2      
  101  000f6 631e            bls.s  L00116     
  102  000f8 0c1c            cmpi.b #252,(a4)+ 
  103  000fc 6618            bne.s  L00116     
  104  000fe 528c            addq.l #1,a4      
  105  00100 2654            movea.l (a4),a3    
  106  00102 d7cd            adda.l a5,a3      
  107  00104 6014            bra.s  L0011a     
  108  00106 0c2d L00106     cmpi.b #252,2(a5) 
  109  0010c 6608            bne.s  L00116     
  110  0010e 266d            movea.l 4(a5),a3   
  111  00112 d7cd            adda.l a5,a3      
  112  00114 6004            bra.s  L0011a     
  113  00116 d7eb L00116     adda.l 12(a3),a3  
  114  0011a 210b L0011a     move.l a3,-(a0)   
  115  0011c 2f08            move.l a0,-(sp)   
  116  0011e 4228            clr.b  -1(a0)     
  117  00122 2f02            move.l d2,-(sp)   
  118  00124 207c L00124     movea.l #488,a0    
  119  0012a 4ebb            jsr    (pc,a0.l)  
  120  0012e 6500            bcs.w  L0024c     
  121  00132 6120            bsr.s  L00154     
  122  00134 4cdf            movem.l (sp)+,d0-d1 
  123  00138 9bcd            suba.l a5,a5      
  124  0013a 2f2e            move.l D003a2(a6),-(sp) 
  125  0013e 207c            movea.l #332,a0    
  126  00144 4ebb            jsr    (pc,a0.l)  
  127  00148 7000            moveq  #0,d0      
  128  0014a 207c            movea.l #628,a0    
  129  00150 4ebb            jsr    (pc,a0.l)  
  130  00154 207c L00154     movea.l #-31834,a0 
  131  0015a d1ce            adda.l a6,a0      
  132  0015c 2d48            move.l a0,D00004(a6) 
  133  00160 2d4f            move.l sp,D00000(a6) 
  134  00164 2d4f            move.l sp,D00008(a6) 
  135  00168 203c            move.l #-252,d0   
  136  0016e d08f            add.l  sp,d0      
  137  00170 b0ae            cmp.l  D00008(a6),d0 
  138  00174 6502            bcs.s  L00178     
  139  00176 4e75            rts               
  140  00178 b0ae L00178     cmp.l  D00004(a6),d0 
  141  0017c 6506            bcs.s  L00184     
  142  0017e 2d40            move.l d0,D00008(a6) 
  143  00182 4e75            rts               
  144  00184 41fa L00184     lea.l  L001f6(pc),a0 
  145  00188 6110            bsr.s  L0019a     
  146  0018a 2f3c            move.l #257,-(sp) 
  147  00190 207c            movea.l #580,a0    
  148  00196 4ebb            jsr    (pc,a0.l)  
  149  0019a 3f01 L0019a     move.w d1,-(sp)   
  150  0019c 7264            moveq  #100,d1    
  151  0019e 7002            moveq  #2,d0      
  152  001a0 4e40            os9    I$WritLn   
  153  001a4 321f            move.w (sp)+,d1   
  154  001a6 4e75            rts               
  155  001a8 202e            move.l D00000(a6),d0 
  156  001ac 90ae            sub.l  D00008(a6),d0 
  157  001b0 4e75            rts               
  158  001b2 202e            move.l D00008(a6),d0 
  159  001b6 90ae            sub.l  D00004(a6),d0 
  160  001ba 4e75            rts               
  161  001bc 48e7 ctrap      movem.l a0-a3/d0-d1,-(sp) 
  162  001c0 302f            move.w 30(sp),d0  
  163  001c4 0440            subi.w #128,d0    
  164  001c8 e440            asr.w  #2,d0      
  165  001ca 0c40            cmpi.w #15,d0     
  166  001ce 660c            bne.s  L001dc     
  167  001d0 41fa            lea.l  L0023d(pc),a0 
  168  001d4 7200            moveq  #0,d1      
  169  001d6 4e40            os9    F$TLink    
  170  001da 640c            bcc.s  L001e8     
  171  001dc 227c L001dc     movea.l #514,a1    
  172  001e2 4ebb            jsr    (pc,a1.l)  
  173  001e6 6564            bcs.s  L0024c     
  174  001e8 4cdf L001e8     movem.l (sp)+,a0-a3/d0-d1 
  175  001ec 508f            addq.l #8,sp      
  176  001ee 5997            subq.l #4,(sp)    
  177  001f0 4e75            rts               
  178  001f2 4afb            dc.w   $4afb      
  179  001f4 0050            ori.w  #10794,(a0) 
  180  001f6 0000 L001f6     equ    *-2        
  181  001f8 2a2a            move.l 8275(a2),d5 
  182  001fc 7461            moveq  #97,d2     
  183  001fe 636b            dc.w   $636b      
  184  00200 204f            movea.l sp,a0      
  185  00202 7665            moveq  #101,d3    
  186  00204 7266            moveq  #102,d1    
  187  00206 6c6f            dc.w   $6c6f      
  188  00208 7720            dc.w   $7720      
  189  0020a 2a2a            move.l 10794(a2),d5 
  190  0020e 0d00            btst.l d6,d0      
  191  00210 2a2a L00210     move.l 10794(a2),d5 
  192  00214 2043            movea.l d3,a0      
  193  00216 616e            bsr.s  L00286     
  194  00218 2774            move.l 105(a4,d2.w),28275(a3) 
  195  0021e 7461            moveq  #97,d2     
  196  00220 6c6c            bge.s  L0028e     
  197  00222 2074            dc.w   $2074      
  198  00224 7261            moveq  #97,d1     
  199  00226 7020            moveq  #32,d0     
  200  00228 6861            dc.w   $6861      
  201  0022a 6e64            bgt.s  L00290     
  202  0022c 6c65            dc.w   $6c65      
  203  0022e 7220            moveq  #32,d1     
  204  00230 2a2a            move.l 10794(a2),d5 
  205  00234 0d00            btst.l d6,d0      
  206  00236 202a L00236     move.l 10794(a2),d0 
  207  0023a 2a20            move.l -(a0),d5   
  208  0023c 006d            ori.w  #24948,26624(a5) 
  209  0023d 0000 L0023d     equ    *-5        
  210  00242 0000 L00242     ori.b  #0,d0      
  211  00246 223c            move.l #64,d1     
  212  0024c 2f08 L0024c     move.l a0,-(sp)   
  213  0024e 41fa            lea.l  L00210(pc),a0 
  214  00252 6100            bsr.w  L0019a     
  215  00256 227c            movea.l #-32738,a1 
  216  0025c d3ce            adda.l a6,a1      
  217  0025e 41fa            lea.l  L00236(pc),a0 
  218  00262 6128            bsr.s  L0028c     
  219  00264 205f            movea.l (sp)+,a0   
  220  00266 5389            subq.l #1,a1      
  221  00268 6122            bsr.s  L0028c     
  222  0026a 41fa            lea.l  L00236(pc),a0 
  223  0026e 5389            subq.l #1,a1      
  224  00270 611a            bsr.s  L0028c     
  225  00272 137c            move.b #13,-1(a1) 
  226  00278 207c            movea.l #-32738,a0 
  227  0027e d1ce            adda.l a6,a0      
  228  00280 6100            bsr.w  L0019a     
  229  00284 4e40            os9    F$Exit     
  230  00286 0000 L00286     equ    *-2        
  231  00288 4e40            os9    F$Exit     
  232  0028c 12d8 L0028c     move.b (a0)+,(a1)+ 
  233  0028e 66fc L0028e     bne.s  L0028c     
  234  00290 4e75 L00290     rts               
  235  00292 4e55            link.w A5,#0      
  236  00296 48e7            movem.l a0/d0-d1,-(sp) 
  237  0029a 41fa            lea.l  L00304(pc),a0 
  238  0029e 2008            move.l a0,d0      
  239  002a0 611a            bsr.s  L002bc     
  240  002a2 72ff            moveq  #255,d1    
  241  002a4 b280            cmp.l  d0,d1      
  242  002a6 6606            bne.s  L002ae     
  243  002a8 70ff            moveq  #255,d0    
  244  002aa 6100            bsr.w  L003c6     
  245  002ae 6134 L002ae     bsr.s  L002e4     
  246  002b0 6148            bsr.s  L002fa     
  247  002b2 4ced            movem.l -8(a5),a0/d1 
  248  002b8 4e5d            unlk   A5         
  249  002ba 4e75            rts               
  250  002bc 48e7 L002bc     movem.l a0-a2,-(sp) 
  251  002c0 2040            movea.l d0,a0      
  252  002c2 203c            move.l #5,d0      
  253  002c8 7200            moveq  #0,d1      
  254  002ca 4e40            os9    F$TLink    
  255  002ce 6508            bcs.s  L002d8     
  256  002d0 7000            moveq  #0,d0      
  257  002d2 4cdf L002d2     movem.l (sp)+,a0-a2 
  258  002d6 4e75            rts               
  259  002d8 2d41 L002d8     move.l d1,D0000c(a6) 
  260  002dc 203c            move.l #-1,d0     
  261  002e2 60ee            bra.s  L002d2     
  262  002e4 4e45 L002e4     tcall  $05,0002   
  263  002e8 6504            bcs.s  L002ee     
  264  002ea 7000            moveq  #0,d0      
  265  002ec 4e75            rts               
  266  002ee 2d41 L002ee     move.l d1,D0000c(a6) 
  267  002f2 203c            move.l #-1,d0     
  268  002f8 4e75            rts               
  269  002fa 4e45 L002fa     tcall  $05,0004   
  270  002fe 65ee            bcs.s  L002ee     
  271  00300 7000            moveq  #0,d0      
  272  00302 4e75            rts               
  273  00304 6364 L00304     bls.s  L0036a     
  274  00306 695f            dc.w   $695f      
  275  00308 7673            moveq  #115,d3    
  276  0030a 796e            dc.w   $796e      
  277  0030c 635f            dc.w   $635f      
  278  0030e 7472            moveq  #114,d2    
  279  00310 6170            bsr.s  L00382     
  280  00312 0000            dc.w   $0         
  281  00314 4e55            link.w A5,#0      
  282  00318 48e7            movem.l d0,-(sp)   
  283  0031c 3d7c            move.w #65,D0002a(a6) 
  284  00322 426e            clr.w  D0002c(a6) 
  285  00326 3d7c            move.w #2,D00046(a6) 
  286  0032c 3d7c            move.w #1,D00048(a6) 
  287  00332 3d7c            move.w #2,D00062(a6) 
  288  00338 3d7c            move.w #2,D00064(a6) 
  289  0033e 4e5d            unlk   A5         
  290  00340 4e75            rts               
  291  00342 2a5f            movea.l (sp)+,a5   
  292  00344 5385 L00344     subq.l #1,d5      
  293  00346 6562            bcs.s  L003aa     
  294  00348 1018            move.b (a0)+,d0   
  295  0034a 67f8            beq.s  L00344     
  296  0034c 0c00            cmpi.b #13,d0     
  297  00350 6758            beq.s  L003aa     
  298  00352 0c00            cmpi.b #32,d0     
  299  00356 67ec            beq.s  L00344     
  300  00358 0c00            cmpi.b #9,d0      
  301  0035c 67e6            beq.s  L00344     
  302  0035e 0c00            cmpi.b #44,d0     
  303  00362 67e0            beq.s  L00344     
  304  00364 5282            addq.l #1,d2      
  305  00366 0c00            cmpi.b #34,d0     
  306  0036a 6730 L0036a     beq.s  L0039c     
  307  0036c 0c00            cmpi.b #39,d0     
  308  00370 672a            beq.s  L0039c     
  309  00372 4868            pea    -1(a0)     
  310  00376 5385 L00376     subq.l #1,d5      
  311  00378 6530            bcs.s  L003aa     
  312  0037a 1018            move.b (a0)+,d0   
  313  0037c 67c6            beq.s  L00344     
  314  0037e 0c00            cmpi.b #13,d0     
  315  00382 6712 L00382     beq.s  L00396     
  316  00384 0c00            cmpi.b #32,d0     
  317  00388 670c            beq.s  L00396     
  318  0038a 0c00            cmpi.b #9,d0      
  319  0038e 6706            beq.s  L00396     
  320  00390 0c00            cmpi.b #44,d0     
  321  00394 66e0            bne.s  L00376     
  322  00396 4228 L00396     clr.b  -1(a0)     
  323  0039a 60a8            bra.s  L00344     
  324  0039c 4850 L0039c     pea    (a0)       
  325  0039e 5385 L0039e     subq.l #1,d5      
  326  003a0 6508            bcs.s  L003aa     
  327  003a2 1218            move.b (a0)+,d1   
  328  003a4 b001            cmp.b  d1,d0      
  329  003a6 66f6            bne.s  L0039e     
  330  003a8 60ec            bra.s  L00396     
  331  003aa 204f L003aa     movea.l sp,a0      
  332  003ac 4857            pea    (sp)       
  333  003ae 2f02            move.l d2,-(sp)   
  334  003b0 5382            subq.l #1,d2      
  335  003b2 6710            beq.s  L003c4     
  336  003b4 e582            asl.l  #2,d2      
  337  003b6 2030 L003b6     move.l (a0,d2.l),d0 
  338  003ba 2190            move.l (a0),(a0,d2.l) 
  339  003be 20c0            move.l d0,(a0)+   
  340  003c0 5182            subq.l #8,d2      
  341  003c2 62f2            bhi.s  L003b6     
  342  003c4 4ed5 L003c4     jmp    (a5)       
  343  003c6 4e55 L003c6     link.w A5,#0      
  344  003ca 2200            move.l d0,d1      
  345  003cc 6100            bsr.w  L003ec     
  346  003d0 6100            bsr.w  L003ee     
  347  003d4 6008            bra.s  L003de     
  348  003d6 4e55            link.w A5,#0      
  349  003da 4afc            illegal            
  350  003dc 2200            move.l d0,d1      
  351  003de 4e40 L003de     os9    F$Exit     
  352  003e2 dead            add.l  -8531(a5),d7 
  353  003e6 003c            ori    #1,ccr     
  354  003ea 4e75            rts               
  355  003ec 4e75 L003ec     rts               
  356  003ee 4e75 L003ee     rts               
  357
  358  003f0 0000            ends              
  358
